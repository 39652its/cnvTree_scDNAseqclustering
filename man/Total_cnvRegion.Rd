% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scDNAclustering_05_SubcloneClustering.R
\name{Total_cnvRegion}
\alias{Total_cnvRegion}
\title{Output defined CNV regions across clusters}
\usage{
Total_cnvRegion(input, Template, pqArm_file, consecutive_region)
}
\arguments{
\item{input}{A named list where each element is a \code{GRanges} object representing a single cell.}

\item{Template}{A data frame recording each subclone's unique chromosome segment template and its corresponding copy number (CN).
The output includes the following columns:
\itemize{
\item \code{chr}: Chromosome name (chr1, chr2, ...).
\item \code{start}: Start position of the chromosome segment.
\item \code{end}: End position of the chromosome segment.
\item \code{region}: Unique region identifier.
\item \code{Subclone}: Subclone identifier.
\item \code{CN}: Copy number for the corresponding segment.
}}

\item{pqArm_file}{In-build cytoband template for selection: \code{hg38}, \code{hg19}, \code{mm10}, \code{mm39}.
Or a filepath of a table for cytoband information seen on Giemsa-stained chromosomes.
It should include the following columns:
\itemize{
\item \code{chrom}: Reference sequence chromosome or scaffold.
\item \code{chromStart}: Start position in genoSeq.
\item \code{chromEnd}: End position in genoSeq.
\item \code{name}: Name of cytogenetic band.
\item \code{gieStain}: Giemsa stain results.
}}

\item{consecutive_region}{A numeric value specifying the minimum length criteria for filtering CNV regions, default=10^7 bp.}
}
\value{
A data frame recording CNV regions across subclones, containing the following columns:
\itemize{
\item \code{chr}: Chromosome name (chr1, chr2, ...).
\item \code{CNV_region}: The index of CNV regions.
\item \code{CN}: Copy number state, categorized as either "amp" (Amplification) or "del" (Deletion).
\item \code{CNV_start}: Start position of the CNV region.
\item \code{CNV_end}: End position of the CNV region.
}
}
\description{
This function identifies and outputs copy number variation (CNV) regions across subclones,
using a predefined segment template and cytoband information.
The CNV regions are classified into two types: amplifications ("amp") and deletions ("del").
}
\examples{

file_path <- system.file("extdata", "example_data.rds", package = "cnvTree")
Example_data <- changeFormat(file = file_path, core = 4)
subclone_template <- system.file("extdata", "SuncloneCN_example_data.rds", package = "cnvTree")
subclone_template <- readRDS(file = subclone_template)

cnv_regions <- Total_cnvRegion(
  input = Example_data,
  Template = subclone_template,
  pqArm_file = "hg38",
  consecutive_region = 10**7
)
head(cnv_regions)


}
